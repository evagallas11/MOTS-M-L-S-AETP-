<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mots M√™l√©s ‚Äì Aide √† domicile</title>
<style>
body { font-family: Arial, sans-serif; padding: 10px; text-align: center; max-width: 600px; margin: auto; }
#grid { display: grid; gap: 2px; margin-top: 20px; justify-content: center; touch-action: none; }
.cell { width: 30px; height: 30px; border: 1px solid #444; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px; user-select: none; }
.cell.selected { background-color: #ffd966; }
.cell.found { background-color: #a0e7a0; }
#timer { font-size: 20px; margin-top: 10px; font-weight: bold; }
#wordList { margin-top: 20px; padding: 0; }
#wordList li { list-style: none; padding: 3px; }
#wordList li.found { text-decoration: line-through; color: green; font-weight: bold; }
#startBtn { padding: 10px 20px; font-size: 16px; margin-top: 10px; }
</style>
</head>
<body>
<h2>Mots m√™l√©s ‚Äì Aide √† domicile</h2>
<label>Votre nom : <input id="playerName" type="text" /></label>
<br>
<button id="startBtn">Commencer</button>
<div id="timer">‚è± Temps : 00:00</div>
<ul id="wordList"></ul>
<div id="grid"></div>
<div id="result"></div>
<script>
const WORDS=["AGENCE","AUTONOMIE","COEUR","DOMICILE","EQUIPE","HYGIENE","PLANNING","RESPECT","SECURITE","ECOUTE"];
const SIZE=14;
let grid=[];
let timerInt, seconds=0;
let foundWords=[];
const MY_EMAIL='evagallas11@gmail.com';

function normalize(str){return str.normalize('NFD').replace(/\p{Diacritic}/gu,'').toUpperCase();}
function createEmptyGrid(){grid=Array.from({length:SIZE},()=>Array(SIZE).fill(''));}
const DIRS=[[0,1],[1,0],[1,1],[-1,1]];
function placeWord(word){for(let attempt=0;attempt<500;attempt++){const dir=DIRS[Math.floor(Math.random()*DIRS.length)];let r=Math.floor(Math.random()*SIZE);let c=Math.floor(Math.random()*SIZE);const endR=r+dir[0]*(word.length-1);const endC=c+dir[1]*(word.length-1);if(endR<0||endR>=SIZE||endC<0||endC>=SIZE)continue;let ok=true;for(let i=0;i<word.length;i++){const rr=r+dir[0]*i,cc=c+dir[1]*i;if(grid[rr][cc]!==''&&grid[rr][cc]!==word[i]){ok=false;break;}}if(!ok)continue;for(let i=0;i<word.length;i++){const rr=r+dir[0]*i,cc=c+dir[1]*i;grid[rr][cc]=word[i];}return true;}return false;}
function fillGrid(){const letters='ABCDEFGHIJKLMNOPQRSTUVWXYZ';for(let r=0;r<SIZE;r++){for(let c=0;c<SIZE;c++){if(grid[r][c]==='')grid[r][c]=letters[Math.floor(Math.random()*letters.length)];}}}
function renderGrid(){const g=document.getElementById('grid');g.innerHTML='';g.style.gridTemplateColumns=`repeat(${SIZE}, 30px)`;for(let r=0;r<SIZE;r++){for(let c=0;c<SIZE;c++){const cell=document.createElement('div');cell.className='cell';cell.textContent=grid[r][c];cell.dataset.r=r;cell.dataset.c=c;g.appendChild(cell);}}}
function renderWordList(){const ul=document.getElementById('wordList');ul.innerHTML='';WORDS.forEach(w=>{const li=document.createElement('li');li.textContent=w;li.id='word-'+normalize(w);ul.appendChild(li);});}

let currentSelection=[];
let isSelecting=false;

function addCell(cell){
    if(!currentSelection.includes(cell)){
        currentSelection.push(cell);
        cell.classList.add('selected');
        checkPartialSelection();
    }
}

function startSelection(e){
    e.preventDefault();
    isSelecting = true;
    currentSelection = [];
    const cell = e.target.closest('.cell');
    if(cell) addCell(cell);
}

function moveSelection(e){
    e.preventDefault();
    if(!isSelecting) return;
    const touch = e.touches ? e.touches[0] : e;
    const element = document.elementFromPoint(touch.clientX, touch.clientY);
    const cell = element.closest('.cell');
    if(cell) addCell(cell);
}

function endSelection(e){
    e.preventDefault();
    currentSelection = [];
    isSelecting = false;
}

function checkPartialSelection(){
    const selectedWord = currentSelection.map(c=>c.textContent).join('');
    const reversed = selectedWord.split('').reverse().join('');
    for(const w of WORDS){
        if(foundWords.includes(w)) continue;
        if(normalize(w)===normalize(selectedWord) || normalize(w)===normalize(reversed)){
            currentSelection.forEach(c => c.classList.add('found'));
            document.getElementById('word-'+normalize(w)).classList.add('found');
            foundWords.push(w);
            currentSelection = [];
            if(foundWords.length === WORDS.length) endGame();
            break;
        }
    }
}

function startTimer(){
    seconds=0;
    timerInt=setInterval(()=>{
        seconds++;
        const m=String(Math.floor(seconds/60)).padStart(2,'0');
        const s=String(seconds%60).padStart(2,'0');
        document.getElementById('timer').textContent=`‚è± Temps : ${m}:${s}`;
    },1000);
}

function endGame(){
    clearInterval(timerInt);
    const name = document.getElementById('playerName').value;
    const finalTime = document.getElementById('timer').textContent;
    document.getElementById('result').innerHTML=`üéâ Bravo ${name}!<br>Temps final : ${finalTime}<br><br><a href='mailto:${MY_EMAIL}?subject=R√©sultat Mot M√™l√©&body=Nom : ${name}%0ATemps : ${finalTime}'>Envoyer mon r√©sultat</a>`;
}

function startGame(){
    const name = document.getElementById('playerName').value;
    if(!name){alert('Veuillez entrer votre nom'); return;}
    document.getElementById('startBtn').style.display='none';
    createEmptyGrid();
    WORDS.forEach(placeWord);
    fillGrid();
    renderWordList();
    renderGrid();
    foundWords = [];
    startTimer();

    const gridDiv = document.getElementById('grid');
    gridDiv.addEventListener('mousedown', startSelection);
    gridDiv.addEventListener('mousemove', moveSelection);
    gridDiv.addEventListener('mouseup', endSelection);
    gridDiv.addEventListener('touchstart', startSelection);
    gridDiv.addEventListener('touchmove', moveSelection);
    gridDiv.addEventListener('touchend', endSelection);
}

document.getElementById('startBtn').addEventListener('click', startGame);
</script>
</body>
</html>
